---
import BaseLayout from "../layouts/BaseLayout.astro";
import { LightGallery } from "astro-lightgallery";
import InlineIcon from "../components/InlineIcon.astro";

const githubUrl = "https://github.com/BellMaster-ru/bmaster";
const demoUrl = "https://demo.bellmaster.ru";

const quickstartRequirements = [
  "Linux (Debian/Ubuntu-подобный дистрибутив) с systemd и apt-get",
  "Python 3.13+, pip и git",
  "ffmpeg для аудио-объявлений и кодека Opus",
  "Доступ в интернет для загрузки frontend-билда при установке",
];

const quickstartSteps = [
  {
    title: "Клонирование",
    text: "Скачайте репозиторий и перейдите в каталог проекта.",
    command: `git clone https://github.com/bellmaster-ru/bmaster.git
cd bmaster`,
  },
  {
    title: "Установка",
    text: "Запустите установочный скрипт, который подготовит сервис и окружение.",
    command: `chmod +x setup.sh
./setup.sh`,
  },
  {
    title: "Запуск",
    text: "Перезагрузите машину и сервис поднимется на https://<ваш IP>:8000",
    command: `sudo systemctl reboot`,
  },
];

const benefits = [
  {
    title: "Запуск на доступном оборудовании",
    text: "Просто разворачивается в локальной сети школы. Не требует дорогостоящих лицензий и специализированных серверов.",
    icon: "server",
  },
  {
    title: "Управление из браузера",
    text: "Редактируйте расписание и управляйте звонками удалённо без физического доступа к оборудованию.",
    icon: "browser",
  },
  {
    title: "Единая панель для всех сценариев",
    text: "Все сценарии дня — звонки, изменения расписания и объявления — доступны в одной панели без переключения между разрозненными системами.",
    icon: "layers",
  },
  {
    title: "Открытый код и развитие",
    text: "Проект распространяется по лицензии MIT. Код открыт для аудита, доработки и адаптации под процессы конкретной школы.",
    icon: "codeBranch",
  },
];

const techBenefits = [
  {
    title: "Аудиодвижок wauxio",
    text: "Проект использует аудиодвижок выращенный «на своей грядке». wauxio позволяет низкоуровнево управлять звуком, в том числе аудио-стримами.",
    icon: "audioLibrary",
  },
  {
    title: "Очередь событий с приоритетами",
    text: "Система управляет звонками через очередь с поддержкой приоритетов и строгого порядка выполнения. Состояние хранится в базе данных и восстанавливается при перезапуске.",
    icon: "clockQueue",
  },
  {
    title: "Низкобитрейтный Opus-стрим",
    text: "Потоковое вещание кодируется в Opus и стабильно работает в локальной сети даже при ограниченной пропускной способности. Нагрузка на сеть остаётся низкой без заметной потери качества..",
    icon: "stream",
  },
  {
    title: "Простая ролевая модель",
    text: "Доступ к панели защищён JWT-аутентификацией и ролевой моделью. Администратор может точечно выдавать права и ограничивать доступ к операциям.",
    icon: "shield",
  },
];

const gallery = [
  {
    src: "/screenshots/main.png",
    alt: "Главная страница BMaster со списком звонков на сегодня",
    caption: "Главная страница: звонки на сегодня",
  },
  {
    src: "/screenshots/schedules.png",
    alt: "Страница управления расписаниями с возможностью редактирования и создания шаблонов",
    caption: "Управление расписаниями и шаблонами звонков",
  },
  {
    src: "/screenshots/calendar.png",
    alt: "Календарный вид с отображением назначенных звонков по датам",
    caption: "Календарь с возможностью назначения расписаний",
  },
  {
    src: "/screenshots/announcements.png",
    alt: "Интерфейс для создания и отправки объявлений в реальном времени",
    caption: "Объявления в реальном времени",
  },
  {
    src: "/screenshots/sounds.png",
    alt: "Раздел управления аудиофайлами и библиотекой звуков",
    caption: "Библиотека аудиофайлов",
  },
  {
    src: "/screenshots/settings.png",
    alt: "Страница настроек системы с параметрами сервера и сети",
    caption: "Настройки системы и конфигурация",
  },
  {
    src: "/screenshots/users.png",
    alt: "Раздел управления пользователями и ролями с разграничением прав доступа",
    caption: "Пользователи, роли и права доступа",
  },
];
---

<BaseLayout
  title="BMaster — современная система школьных звонков"
  description="BMaster — открытая система управления школьными звонками и объявлениями: веб-интерфейс, гибкое расписание и удалённый доступ."
>
  <main class="landing">
    <section
      class="hero reveal reveal-stagger"
      aria-labelledby="hero-title"
      style="--reveal-delay: 20ms;"
    >
      <div class="hero__inner">
        <p class="hero__kicker">
          Система управления школьными звонками и объявлениями
        </p>
        <h1 id="hero-title">
          BMaster — открытая система управления школьными звонками и
          объявлениями
        </h1>
        <p class="hero__lead">
          BMaster — это веб-ориентированная система для управления школьными
          звонками и аудио-объявлениями. Приложение разворачивается на доступном
          оборудовании (например, Raspberry Pi) и позволяет администрации школы
          управлять расписанием через современный браузер.
        </p>
        <div class="hero__actions">
          <a
            class="btn btn--primary"
            href={demoUrl}
            target="_blank"
            rel="noopener noreferrer"
          >
            Открыть демо
          </a>
          <a class="btn btn--ghost" href="#gallery">Смотреть интерфейс</a>
          <a
            class="btn btn--ghost"
            href={githubUrl}
            target="_blank"
            rel="noopener noreferrer"
          >
            Открыть GitHub
          </a>
        </div>
      </div>
      <figure class="hero__media">
        <img
          src="/screenshots/main.png"
          alt="Скриншот главной панели BMaster с расписанием звонков"
          loading="eager"
          decoding="async"
        />
      </figure>
    </section>

    <section
      class="section quickstart reveal reveal-stagger"
      id="quickstart"
      aria-labelledby="quickstart-title"
      style="--reveal-delay: 80ms;"
    >
      <div class="section__head">
        <h2 id="quickstart-title" class="section__title">Быстрый старт</h2>
        <p>Минимальный запуск на Debian/Ubuntu-подобной системе с systemd.</p>
      </div>

      <ul class="quickstart__requirements">
        {
          quickstartRequirements.map((item) => (
            <li class="quickstart__requirement">{item}</li>
          ))
        }
      </ul>

      <div class="quickstart__steps">
        {
          quickstartSteps.map((step, index) => (
            <article class="quickstart-step">
              <p class="quickstart-step__index">Шаг {index + 1}</p>
              <h3>{step.title}</h3>
              <p>{step.text}</p>
              <pre>
                <code>{step.command}</code>
              </pre>
            </article>
          ))
        }
      </div>

      <p class="quickstart__note">
        После первого запуска смените стандартный пароль от сервисного доступа <code
          >auth.service.password</code
        > в
        <code>data/config.yml</code>.
      </p>

      <div class="quickstart__actions">
        <a
          class="btn btn--primary"
          href={demoUrl}
          target="_blank"
          rel="noopener noreferrer"
        >
          Открыть демо
        </a>
        <a
          class="btn btn--ghost"
          href={githubUrl}
          target="_blank"
          rel="noopener noreferrer"
        >
          Полный README / GitHub
        </a>
      </div>
    </section>

    <section
      class="section reveal reveal-stagger"
      id="benefits"
      aria-labelledby="benefits-title"
      style="--reveal-delay: 140ms;"
    >
      <div class="section__head">
        <h2 id="benefits-title" class="section__title">Преимущества</h2>
        <p>Чем BMaster лучше типовых решений</p>
      </div>

      <div class="benefits-grid">
        {
          benefits.map((feature) => (
            <article class="benefit-card">
              <div class="benefit-card__head">
                <span class="icon-badge benefit-card__icon" aria-hidden="true">
                  <InlineIcon name={feature.icon} />
                </span>
                <h3>{feature.title}</h3>
              </div>
              <p>{feature.text}</p>
            </article>
          ))
        }
      </div>
    </section>

    <section
      class="section section--tech reveal reveal-stagger"
      id="tech-benefits"
      aria-labelledby="tech-benefits-title"
      style="--reveal-delay: 200ms;"
    >
      <div class="section__head">
        <h2 id="tech-benefits-title" class="section__title">
          Технические преимущества
        </h2>
        <p>Инженерные решения, которые обеспечивают предсказуемую работу.</p>
      </div>

      <div class="benefits-grid">
        {
          techBenefits.map((feature) => (
            <article class="benefit-card">
              <div class="benefit-card__head">
                <span class="icon-badge benefit-card__icon" aria-hidden="true">
                  <InlineIcon name={feature.icon} />
                </span>
                <h3>{feature.title}</h3>
              </div>
              <p>{feature.text}</p>
            </article>
          ))
        }
      </div>
    </section>

    <section
      class="section reveal reveal-stagger"
      id="problem-solution"
      aria-labelledby="problem-solution-title"
      style="--reveal-delay: 240ms;"
    >
      <div class="section__head">
        <h2 id="problem-solution-title" class="section__title">
          Проблема и решение
        </h2>
        <p>Почему традиционные системы больше не подходят</p>
      </div>

      <div class="split-grid">
        <article class="info-card">
          <div class="info-card__head">
            <span class="icon-badge info-card__icon" aria-hidden="true">
              <InlineIcon name="problem" />
            </span>
            <h3>Проблема</h3>
          </div>
          <ul class="simple-list">
            <li>
              Использование устаревших аппаратных таймеров и закрытых решений.
            </li>
            <li>Высокая стоимость коммерческих систем.</li>
            <li>Сложность внесения изменений в расписание.</li>
            <li>Отсутствие гибкости для нестандартных учебных сценариев.</li>
          </ul>
        </article>

        <article class="info-card info-card--highlight">
          <div class="info-card__head">
            <span class="icon-badge info-card__icon" aria-hidden="true">
              <InlineIcon name="solution" />
            </span>
            <h3>Решение</h3>
          </div>
          <ul class="simple-list">
            <li>Централизованное управление через веб-интерфейс.</li>
            <li>Быстрое редактирование расписания без остановки системы.</li>
            <li>Поддержка аудио-объявлений в реальном времени.</li>
            <li>Гибкая архитектура, готовая к масштабированию.</li>
          </ul>
        </article>
      </div>
    </section>

    <section
      class="section reveal reveal-stagger"
      id="gallery"
      aria-labelledby="gallery-title"
      style="--reveal-delay: 300ms;"
    >
      <div class="section__head">
        <h2 id="gallery-title" class="section__title">Галерея интерфейса</h2>
        <p>Текущий экран панели управления.</p>
      </div>

      <LightGallery
        layout={{
          imgs: gallery,
          classContainer: "gallery-grid",
          classItem: "gallery-item",
        }}
        options={{
          thumbnail: true,
          zoom: true,
        }}
        addPlugins={["fullscreen", "zoom"]}
      />
    </section>

    <section
      class="section cta reveal reveal-stagger"
      id="cta"
      aria-labelledby="cta-title"
      style="--reveal-delay: 340ms;"
    >
      <div>
        <h2 id="cta-title">BMaster открыт для внедрения и доработки</h2>
        <p>
          BMaster — это бесплатная и открытая альтернатива коммерческим
          решениям. Разверните систему в своей школе и адаптируйте её под
          собственные нужды.
        </p>
      </div>
      <div class="cta__actions">
        <a
          class="btn btn--primary"
          href={githubUrl}
          target="_blank"
          rel="noopener noreferrer"
        >
          Перейти к исходному коду
        </a>
      </div>
    </section>
  </main>
</BaseLayout>
